<?php
    $fd = fopen (__FILE__, "r");
    $contents = fread ($fd, filesize (__FILE__));
    fclose ($fd);
    preg_match("/<h1[^>]*>([^<]*)<\/h1>/","$contents",$matches);
    $pagtit = $matches[1];
    require_once("/home/httpd/html/PHYSIOME/tpt/phead.html"); ?>

<?php
/* 
  $DIR=$_SERVER['QUERY_STRING'];
  $DIR=ereg_replace("\.\.", "", $DIR); // .. unsafe
  $DIR=ereg_replace("[^0-9A-Za-z/\.]", "_", $DIR); // unsafe chars
  print '<h1>JSim example models list: ' . $DIR . "</h1>\n";
  */
?>

<table border=true cellspacing=0 cellpadding=2>
<tr>
<tr>
  <th>Model</th>
  <th>View</th>
  <th>Run</th>
  <th>Description</th>
</tr>

<?php
/*
  $DIR=$_SERVER['QUERY_STRING'];
  $DIR=ereg_replace("\.\.", "", $DIR); // .. unsafe
  $DIR=ereg_replace("[^0-9A-Za-z/\.]", "_", $DIR); // unsafe chars
  */
  
  $files=array();
  $d = opendir($DIR); #open directory
  while ($f = readdir($d)) { 
    if (ereg("\.mod",$f)){
      $b = ereg_replace("\.mod", "", $f);
      $files[] = $b;
    }
  }
  
  foreach ($files as $key => $f) {
    print "<tr>\n";
    $MOD = $DIR . "/" . $f . ".mod";
    print '<td>' . $f . "</td>\n";
    print '<td><a href="' . $MOD . '">MML</a></td>' . "\n";
    print '<td><a href="../applet.html?examples/' . $MOD 
      . '">Applet</a></td>' . "\n";
    $DESC=shell_exec("head -1 " . $MOD);
    print '<td>' . $DESC . "</td>\n";
    print "</tr>\n\n";   
  }
  
?>
</table>

<?php require_once("/home/httpd/html/PHYSIOME/tpt/ptail.html") ?>
